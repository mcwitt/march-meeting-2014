%\documentclass{beamer}
\documentclass[handout]{beamer}

\usepackage{amsmath}
\usepackage{tikz}
\usepackage{commath}

\graphicspath{{figures/}}
\DeclareGraphicsExtensions{.pdf,.png,.jpg}

\usetikzlibrary{arrows,shapes}

\newcommand{\ev}[1]{\langle #1 \rangle} % expectation value

\title[Quantum GI]
{Distinguishing graphs with a quantum annealer
  using susceptibility measurements} 

\author[Wittmann, Hen, Young]{%
  Matthew~Wittmann\inst{1} \and
  Itay~Hen\inst{2} \and
  A.~P.~Young\inst{1}
}

\institute[UCSC and ISI]
{
  \inst{1}%
  Physics Department\\
  University of California, Santa Cruz
  \and
  \inst{2}%
  Information Sciences Institute\\
  University of Southern California
}
\date[APS MM 2014]{APS March Meeting, 2014}

\begin{document}

% Don't show "Figure:" in captions
\setbeamertemplate{caption}{\insertcaption}

% TikZ commands needed for fancy equation annotation
% see http://www.texample.net/tikz/examples/beamer-arrows/
\tikzstyle{every picture}+=[remember picture]
\tikzstyle{na} = [baseline=-.5ex]
\everymath{\displaystyle}

\frame{\titlepage}
\section{Background}
\begin{frame}[t]
  \label{GIdef}
  \frametitle{Graph Isomorphism (GI) Problem}
  Are two graphs really the same apart from the labeling of the vertices?
  \vskip 4ex
  \begin{columns}[T]
    \column{0.27\textwidth}
    \centering
    $G=(E_G,\,V_G)$ \\[4ex]
    \includegraphics[scale=0.36]{Graph_isomorphism_a}

    \column{0.27\textwidth}
    \centering
    $H=(E_H,\,V_H)$ \\[4ex]
    \includegraphics[scale=0.36]{Graph_isomorphism_b}

    \column{0.27\textwidth}
    \centering
    \alert<1|handout:1>{$G \cong H$\uncover<1|handout:1>{?}}
    \uncover<2-|handout:2-> {%
      \begin{align*}
        a &\leftrightarrow 1 \\
        b &\leftrightarrow 6 \\
        c &\leftrightarrow 8 \\
        d &\leftrightarrow 3 \\
        g &\leftrightarrow 5 \\
        h &\leftrightarrow 2 \\
        i &\leftrightarrow 4 \\
        j &\leftrightarrow 7
      \end{align*}
    }
  \end{columns}
\end{frame}
\begin{frame}
  \frametitle{Graph invariants}
  E.g.
  \begin{itemize}
    \item number of vertices and edges
    \item degree distribution
    \item spectrum of adjacency matrix
    \item \ldots and many more (any quantity which is invariant under
      relabeling the vertices)
  \end{itemize}
  \begin{definition}
    An invariant $I$ is \alert{complete} if $I(G) = I(H) \iff G \cong H$.
  \end{definition}
  There are no known general, complete invariants. Finding one would provide an
  easy solution to the GI problem!
\end{frame}
\begin{frame}
  \frametitle{Features of the GI problem}
  \begin{itemize}
    \item Special cases (i.e. those for which complete invariants can be
      defined) can be solved efficiently by classical algorithms
    \item But the best known general algorithms are exponentially complex in
      the number of vertices
    \item Complexity class \alert{NP}, but unlikely to be NP-complete (the same
      is believed of factoring)
  \end{itemize}
\end{frame}
\begin{frame}
  \frametitle{Physical studies of the GI problem}
    \begin{columns}
      \column{0.7\textwidth}
      \begin{itemize}
        \item Rudolph (2002):
          Exploit physical intuition to construct graph invariants
        \item Hen and Young (2012):
          Propose that the GI problem could be solved using a
          quantum annealer
        \item Gaitan and Clark (2013):
          Propose adiabatic quantum algorithm for GI
        \item Vinci et al. (2013):
          Experimental implementation of GI algorithm using D-Wave One quantum
          annealer
      \end{itemize}
      \column{0.3\textwidth}
      \includegraphics[width=\textwidth]{d_wave_one_system}
    \end{columns}
\end{frame}
\begin{frame}
  %\frametitle{Ising Hamiltonian encoding of a graph}
  %\frametitle{Graph $\longrightarrow$ Ising Hamiltonian}
  \frametitle{Graph encoding}
  \begin{equation*}
    H_p(G) = 
    \tikz[baseline]{
      \node[fill=blue!20,ellipse,anchor=base] (t1)
      {$\sum_{(i,\,j) \in E} \sigma^z_i \sigma^z_j$};
    }
    \uncover<2->{ % only show field term starting on slide 2
      -
      \tikz[baseline]{
        \node[fill=red!20,ellipse,anchor=base] (t2)
        {$h \sum \sigma^z_i$};
      }
    }
  \end{equation*}
  \begin{itemize}
    \item Antiferromagnetic Ising model
      \tikz[na]\node [coordinate] (n1) {};
    \item<2-> Longitudinal field to break $z$-symmetry
      \tikz[na]\node [coordinate] (n2) {};
    \item<3-> Spectrum of $H(G)$ \alert{not} a complete invariant\ldots
  \end{itemize}

  % Draw edges from bullet points to terms (note 'overlay' style).
  \begin{tikzpicture}[overlay]
    \path[->] (n1) edge [out=0,in=-30] (t1);
    \path[->]<2-> (n2) edge [out=0,in=-90] (t2);
  \end{tikzpicture}
  \begin{definition}<3->
    $G_1,\,G_2$ \alert{co-Ising} $\iff$ $H(G_1)$, $H(G_2)$
    co-spectral for all $h$
  \end{definition}
\end{frame}
\begin{frame}
  \frametitle{Adiabatic quantum algorithm for GI}
  \begin{itemize}
    \item Driver Hamiltonian $H_d$
      \tikz[na]\node [coordinate] (n3) {};
  \end{itemize}
  \begin{equation*}
    H = (1-s)\,
    \tikz[baseline]{ \node[fill=blue!20,ellipse,anchor=base] (t3)
      {$\frac{1}{2} \sum \sigma^x_i$};
    }
    + s\,
    \tikz[baseline]{ \node[fill=red!20,ellipse,anchor=base] (t4)
      {$H_p(G)$};
    }
  \end{equation*}
  \begin{itemize}
    \item Problem Hamiltonian $H_p$
      \tikz[na]\node [coordinate] (n4) {};
  \end{itemize}
  \begin{tikzpicture}[overlay]
    \path[->] (n3) edge [out=0,in=90] (t3);
    \path[->] (n4) edge [out=0,in=-90] (t4);
  \end{tikzpicture}
  \begin{block}{Quantum adiabatic algorithm (QAA)}
    \begin{enumerate}
      \item Prepare system in ground state of $H_d$ (easy)
      \item Take $s$ from 0 to 1 \alert{slowly}.  System remains in ground state
        of the instantaneous Hamiltonian (adiabatic theorem)
      \item Ground state of $H_p \longrightarrow$ solution of optimization
        problem\ldots
    \end{enumerate}
  \end{block}
  \alert{Use measurements of the instantaneous ground state throughout the
    adiabatic evolution to distinguish non-isomorphic graphs}
\end{frame}
\begin{frame}
  \frametitle{Measurements}
  \begin{itemize}
    \item Energies $E=\ev{H(G)}$, $E_G=\ev{H_p(G)}$
    \item Magnetizations $m_z$, $m_x$
    \item Spin glass overlap
    \begin{equation*}
      Q_2 = \frac{1}{N} \sqrt{
        \sum_{i,\,j} \del{
          \ev{\sigma^z_i \sigma^z_j} -
          \ev{\sigma^z_i} \ev{\sigma^z_j}
        }^2
      }
    \end{equation*}
    \item Analagous quantity in terms of susceptibilities
    \begin{equation*}
      Q_2' = \frac{1}{N} \sqrt{\sum_{i,\,j} \del{\dpd{\ev{\sigma^z_i}}{h_j}}^2}
    \end{equation*}
    \item All except $Q_2$ measurable on the D-Wave machine
  \end{itemize}
\end{frame}
\begin{frame}
  \frametitle{Test case: small co-Ising graphs}
  \begin{itemize}
    \item Study pair of 13-vertex co-Ising graphs $G_{13}$ and $G_{13}'$
    \item Found to be difficult to distinguish by Vinci et al. (using
      measurements at $s \rightarrow 1$ and with $h=0$)
    \item Study the parameter space of $h$, $s$ using numerical minimization to
      find the ground state
    \item Which parameters give the largest difference in measured quantities?
  \end{itemize}
\end{frame}
\begin{frame}
  \frametitle{Results}
  \framesubtitle{Absolute value of difference between $G_{13}$ and $G_{13}'$}
  \includegraphics[width=\textwidth]{delta-grid}
\end{frame}
\begin{frame}
  \frametitle{Future work}
  \begin{itemize}
    \item Carry out tests on newest D-Wave hardware (capable of measurements at
      intermediate $s$).
  \end{itemize}
\end{frame}
\end{document}
